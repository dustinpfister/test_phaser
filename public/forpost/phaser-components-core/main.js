

// make a sprite sheet
var mkSheet = function (game) {
    // sprite sheet generated by canvas
    var canvas = document.createElement('canvas'),
    ctx = canvas.getContext('2d');
    canvas.width = 96;
    canvas.height = 32;
    // blue box (player)
    ctx.fillStyle = '#0000ff';
    ctx.fillRect(0, 0, 32, 32);
    // blue box (player)
    ctx.fillStyle = '#ff0000';
    ctx.fillRect(32, 0, 32, 32);
    game.cache.addSpriteSheet('blocks', null, canvas, 32, 32, 2, 0, 0);
};

var game = new Phaser.Game(320, 240, Phaser.AUTO, 'gamearea');

game.state.add('animations', {
    create: function () {
        mkSheet(game);
        var sprite = game.add.sprite(0, 0, 'blocks');
        sprite.animations.add('flash', [0, 1], 8, true);
        sprite.animations.play('flash');
    }
});

// for the components property
game.state.add('components', {
    create: function () {
        game.data = {};
        // make a simple sheet
        mkSheet(game);
        var sprite = game.add.sprite(0, 0),
        textStyle = {
            fill: 'white',
            font: '10px courier'
        };
        Object.keys(sprite.components).forEach(function (componentName, i) {
            var text = game.add.text(0, i * 10, componentName, textStyle);
        });
    }
});

// exists
game.state.add('exists', {
    create: function () {

        mkSheet(game);

        var group = game.add.group();

        var i = 0,
        len = 10;
        while (i < len) {

            var sprite = game.make.sprite(0, 0, 'blocks', 0);
            sprite.exists = false;

            sprite.inputEnabled = true;

            group.add(sprite);

            i += 1;

        }

    }
});

game.state.start('exists');
